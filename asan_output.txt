🔍 Memory profiling enabled (statistics reset)
📊 Memory: Alloc:29 Dealloc:1 Peak:116 Current:112 Leaks:28
📋 Symbol: A:0/0 R:25
📋 String: A:2/0 R:2
📋 Vector: A:1/1 Rel:1
📋 List: A:1/0
📋 Function: A:25/0 R:25
🚨 LEAK: 28 objects, 112 bytes

🚨 MEMORY LEAK DETECTED at Test Complete:
   ┌─────────────────────────────────────────────────────────┐
   │ LEAK SUMMARY                                            │
   ├─────────────────────────────────────────────────────────┤
   │ Total Leaks:                28 allocations                    │
   │ Current Memory:            112 bytes                         │
   │ Peak Memory:              116 bytes                         │
   │ Allocations:                29                               │
   │ Deallocations:               1                               │
   └─────────────────────────────────────────────────────────┘
🔍 String: 2 leaks
🔍 List: 1 leaks
🔍 Function: 25 leaks
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:140:test_autorelease_pool_basic:PASS
🔍 Memory profiling enabled (statistics reset)
📊 Memory: Alloc:5 Dealloc:2 Peak:20 Current:12 Leaks:3
📋 String: A:2/0 R:1
📋 Vector: A:2/2 Rel:2
📋 List: A:1/0
🚨 LEAK: 3 objects, 12 bytes

🚨 MEMORY LEAK DETECTED at Test Complete:
   ┌─────────────────────────────────────────────────────────┐
   │ LEAK SUMMARY                                            │
   ├─────────────────────────────────────────────────────────┤
   │ Total Leaks:                 3 allocations                    │
   │ Current Memory:             12 bytes                         │
   │ Peak Memory:               20 bytes                         │
   │ Allocations:                 5                               │
   │ Deallocations:               2                               │
   └─────────────────────────────────────────────────────────┘
🔍 String: 2 leaks
🔍 List: 1 leaks
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:141:test_autorelease_pool_nested:PASS
🔍 Memory profiling enabled (statistics reset)
📊 Memory: Alloc:21 Dealloc:13 Peak:84 Current:32 Leaks:8
📋 String: A:15/11 R:5 Rel:16 AR:15
📋 Vector: A:1/1 Rel:1
📋 List: A:5/1 R:4 Rel:2 AR:1
🚨 LEAK: 8 objects, 32 bytes

🚨 MEMORY LEAK DETECTED at Test Complete:
   ┌─────────────────────────────────────────────────────────┐
   │ LEAK SUMMARY                                            │
   ├─────────────────────────────────────────────────────────┤
   │ Total Leaks:                 8 allocations                    │
   │ Current Memory:             32 bytes                         │
   │ Peak Memory:               84 bytes                         │
   │ Allocations:                21                               │
   │ Deallocations:              13                               │
   └─────────────────────────────────────────────────────────┘
🔍 String: 4 leaks
🔍 List: 4 leaks
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:142:test_autorelease_pool_memory_cleanup:PASS
🔍 Memory profiling enabled (statistics reset)

=== COW Assumptions: RC Behavior ===
After make_map: RC=1
After AUTORELEASE: RC=1
✓ AUTORELEASE does NOT increase RC
After RETAIN: RC=2
✓ RC=2 would trigger COW in map_assoc_cow
After RELEASE: RC=1
✓ All COW assumptions verified!
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:143:test_cow_assumptions_rc_behavior:PASS
🔍 Memory profiling enabled (statistics reset)

=== Simple COW Test ===
After make_map: RC=1
After map_assoc_cow: RC=1
✓ Basic COW functionality works!
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:144:test_simple_cow_basic:PASS
🔍 Memory profiling enabled (statistics reset)

=== Minimal COW Test ===
After make_map: RC=1
After map_assoc_cow: RC=1
✓ Minimal COW test passed!
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:145:test_cow_minimal_basic:PASS
🔍 Memory profiling enabled (statistics reset)

=== Actual COW Demonstration ===
Initial map: RC=1, count=1
After RETAIN: RC=2
Before COW: RC=2
After COW: Original RC=2
✓ COW demonstration successful!
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:146:test_cow_actual_cow_demonstration:PASS
🔍 Memory profiling enabled (statistics reset)
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:210:test_parse_basic_types:PASS
🔍 Memory profiling enabled (statistics reset)
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:211:test_parse_collections:PASS
🔍 Memory profiling enabled (statistics reset)
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:212:test_parse_comments:PASS
🔍 Memory profiling enabled (statistics reset)
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:213:test_parse_metadata:PASS
🔍 Memory profiling enabled (statistics reset)
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:214:test_parse_utf8_symbols:PASS
🔍 Memory profiling enabled (statistics reset)
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:215:test_keyword_evaluation:PASS
🔍 Memory profiling enabled (statistics reset)
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:216:test_keyword_map_access:PASS
🔍 Memory profiling enabled (statistics reset)
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:217:test_parse_multiline_expressions:PASS
🔍 Memory profiling enabled (statistics reset)
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:243:test_simple_try_catch_exception_caught:PASS
🔍 Memory profiling enabled (statistics reset)
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:244:test_simple_try_catch_no_exception:PASS
🔍 Memory profiling enabled (statistics reset)
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:247:test_exception_with_autorelease:PASS
🔍 Memory profiling enabled (statistics reset)
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:375:test_list_count:PASS
🔍 Memory profiling enabled (statistics reset)
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:376:test_list_creation:PASS
🔍 Memory profiling enabled (statistics reset)
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:377:test_symbol_creation:PASS
🔍 Memory profiling enabled (statistics reset)
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:378:test_string_creation:PASS
🔍 Memory profiling enabled (statistics reset)
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:379:test_vector_creation:PASS
🔍 Memory profiling enabled (statistics reset)
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:380:test_map_creation:PASS
🔍 Memory profiling enabled (statistics reset)
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:381:test_array_map_builtin:PASS
🔍 Memory profiling enabled (statistics reset)
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:382:test_integer_creation:PASS
🔍 Memory profiling enabled (statistics reset)
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:383:test_float_creation:PASS
🔍 Memory profiling enabled (statistics reset)
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:384:test_nil_creation:PASS
🔍 Memory profiling enabled (statistics reset)
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:387:test_load_multiline_file:PASS
🔍 Memory profiling enabled (statistics reset)
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:390:test_map_function:PASS
🔍 Memory profiling enabled (statistics reset)
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:393:test_fixed_creation_and_conversion:PASS
🔍 Memory profiling enabled (statistics reset)
📊 Memory: Alloc:13 Dealloc:5 Peak:52 Current:32 Leaks:8
📋 Symbol: A:0/0 R:8 AR:2
📋 Vector: A:1/1 Rel:1
📋 List: A:12/4 R:8 Rel:8 AR:4
📋 Function: A:0/0 R:4 AR:4
🚨 LEAK: 8 objects, 32 bytes

🚨 MEMORY LEAK DETECTED at Test Complete:
   ┌─────────────────────────────────────────────────────────┐
   │ LEAK SUMMARY                                            │
   ├─────────────────────────────────────────────────────────┤
   │ Total Leaks:                 8 allocations                    │
   │ Current Memory:             32 bytes                         │
   │ Peak Memory:               52 bytes                         │
   │ Allocations:                13                               │
   │ Deallocations:               5                               │
   └─────────────────────────────────────────────────────────┘
🔍 List: 8 leaks
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:394:test_fixed_arithmetic_operations:PASS
🔍 Memory profiling enabled (statistics reset)
📊 Memory: Alloc:11 Dealloc:4 Peak:44 Current:28 Leaks:7
📋 Symbol: A:0/0 R:6
📋 Vector: A:1/1 Rel:1
📋 List: A:10/3 R:7 Rel:6 AR:3
📋 Function: A:0/0 R:3 AR:3
🚨 LEAK: 7 objects, 28 bytes

🚨 MEMORY LEAK DETECTED at Test Complete:
   ┌─────────────────────────────────────────────────────────┐
   │ LEAK SUMMARY                                            │
   ├─────────────────────────────────────────────────────────┤
   │ Total Leaks:                 7 allocations                    │
   │ Current Memory:             28 bytes                         │
   │ Peak Memory:               44 bytes                         │
   │ Allocations:                11                               │
   │ Deallocations:               4                               │
   └─────────────────────────────────────────────────────────┘
🔍 List: 7 leaks
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:395:test_fixed_mixed_type_operations:PASS
🔍 Memory profiling enabled (statistics reset)
📊 Memory: Alloc:10 Dealloc:4 Peak:40 Current:24 Leaks:6
📋 Symbol: A:0/0 R:6 AR:3
📋 Vector: A:1/1 Rel:1
📋 List: A:9/3 R:6 Rel:6 AR:3
📋 Function: A:0/0 R:3 AR:3
🚨 LEAK: 6 objects, 24 bytes

🚨 MEMORY LEAK DETECTED at Test Complete:
   ┌─────────────────────────────────────────────────────────┐
   │ LEAK SUMMARY                                            │
   ├─────────────────────────────────────────────────────────┤
   │ Total Leaks:                 6 allocations                    │
   │ Current Memory:             24 bytes                         │
   │ Peak Memory:               40 bytes                         │
   │ Allocations:                10                               │
   │ Deallocations:               4                               │
   └─────────────────────────────────────────────────────────┘
🔍 List: 6 leaks
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:396:test_fixed_division_with_remainder:PASS
🔍 Memory profiling enabled (statistics reset)
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:397:test_fixed_precision_limits:PASS
🔍 Memory profiling enabled (statistics reset)
📊 Memory: Alloc:15 Dealloc:4 Peak:60 Current:44 Leaks:11
📋 Symbol: A:0/0 R:6
📋 Vector: A:1/1 Rel:1
📋 List: A:14/3 R:11 Rel:6 AR:3
📋 Function: A:0/0 R:3 AR:3
🚨 LEAK: 11 objects, 44 bytes

🚨 MEMORY LEAK DETECTED at Test Complete:
   ┌─────────────────────────────────────────────────────────┐
   │ LEAK SUMMARY                                            │
   ├─────────────────────────────────────────────────────────┤
   │ Total Leaks:                11 allocations                    │
   │ Current Memory:             44 bytes                         │
   │ Peak Memory:               60 bytes                         │
   │ Allocations:                15                               │
   │ Deallocations:               4                               │
   └─────────────────────────────────────────────────────────┘
🔍 List: 11 leaks
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:398:test_fixed_variadic_operations:PASS
🔍 Memory profiling enabled (statistics reset)
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:400:test_fixed_comparison_operators:PASS
🔍 Memory profiling enabled (statistics reset)
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:403:test_fixed_basic_creation:PASS
🔍 Memory profiling enabled (statistics reset)
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:404:test_fixed_negative_values:PASS
🔍 Memory profiling enabled (statistics reset)
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:405:test_fixed_precision:PASS
🔍 Memory profiling enabled (statistics reset)
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:406:test_fixed_multiplication_raw:PASS
🔍 Memory profiling enabled (statistics reset)
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:407:test_fixed_mixed_type_promotion:PASS
🔍 Memory profiling enabled (statistics reset)
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:408:test_fixed_saturation_max:PASS
🔍 Memory profiling enabled (statistics reset)
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:409:test_fixed_saturation_min:PASS
🔍 Memory profiling enabled (statistics reset)
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:410:test_fixed_division_raw:PASS
🔍 Memory profiling enabled (statistics reset)
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:411:test_fixed_edge_cases:PASS
🔍 Memory profiling enabled (statistics reset)
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:412:test_fixed_tag_consistency:PASS
🔍 Memory profiling enabled (statistics reset)
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:415:test_fixed_addition_builtin:PASS
🔍 Memory profilinUNHANDLED: UseAfterFreeError: Use-after-free detected! Object 0x60300000f100 (type=List) was already freed (rc=0). This indicates the object was released more times than retained, likely due to duplicate AUTORELEASE or incorrect memory management. at src/memory.c:170:0
g enabled (statistics reset)
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:416:test_fixed_subtraction_builtin:PASS
🔍 Memory profiling enabled (statistics reset)
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:417:test_fixed_mixed_addition:PASS
🔍 Memory profiling enabled (statistics reset)
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:418:test_fixed_negative_addition:PASS
🔍 Memory profiling enabled (statistics reset)
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:421:test_fixed_multiplication_builtin:PASS
🔍 Memory profiling enabled (statistics reset)
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:422:test_fixed_division_builtin:PASS
🔍 Memory profiling enabled (statistics reset)
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:423:test_fixed_mixed_multiplication:PASS
🔍 Memory profiling enabled (statistics reset)
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:424:test_fixed_division_by_zero:PASS
🔍 Memory profiling enabled (statistics reset)
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:425:test_fixed_complex_arithmetic:PASS
🔍 Memory profiling enabled (statistics reset)
Testing factorial call (should return 6)...
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:436:test_recur_factorial:PASS
🔍 Memory profiling enabled (statistics reset)
Testing deep call (should return 3)...
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:437:test_recur_deep_recursion:PASS
🔍 Memory profiling enabled (statistics reset)
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:438:test_recur_arity_error:PASS
🔍 Memory profiling enabled (statistics reset)
Testing countdown call (should return :done)...
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:439:test_recur_countdown:PASS
🔍 Memory profiling enabled (statistics reset)
Testing sum call (should return 15)...
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:440:test_recur_sum:PASS
🔍 Memory profiling enabled (statistics reset)
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:441:test_recur_tail_position_error:PASS
🔍 Memory profiling enabled (statistics reset)
Testing if statement in function (should return :yes)...
/Users/theisen/Projects/tiny-clj/src/tests/unity_test_runner.c:442:test_if_bug_in_functions:PASS
⚠️  WARNING: Potential double-free detected! Object destructions (3) significantly exceed allocations (0).
